(this["webpackJsonpultraman-lienquan"]=this["webpackJsonpultraman-lienquan"]||[]).push([[0],{88:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var i=a(9),r=a.n(i),n=a(12),o=a(6),s=a(10),c=a(0),l=(a(88),a(4)),u=function e(){Object(l.a)(this,e)};u.CAMERA_WIDTH=4,u.CAMERA_HEIGHT=8,u.GAP=1,u.GRAVITY=20,u.PLAYER_WIDTH=.25,u.PLAYER_HEIGHT=.25,u.PLAYER_SCALE=5,u.JUMP_FORCE=-10,u.RUN_FORCE=2,u.BLOCK_SIZE=(u.BLOCK_BLOCK_SIZE=2*u.CAMERA_WIDTH)/5,u.BLOCK_OFFSET_Y=u.CAMERA_HEIGHT/1.7;var b,h,p,y,j,d,O,v,g,f,m,w,A,E,I,_,C,S,H,T,x,k,R,M,P,L,B,G,D,W,z,F,Y,K,U,J,Z,V,N,q,Q,X,$,ee,te,ae,ie,re,ne,oe,se,ce,le,ue,be,he,pe,ye,je,de,Oe,ve,ge,fe,me,we,Ae,Ee,Ie,_e,Ce,Se=a(2),He=a(5),Te=a(1),xe=a(8),ke=a(7),Re=a(3),Me=(a(13),b=Object(c.Inject)("physicsWorld"),h=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"physicsWorld",p,Object(Te.a)(e)),e}return Object(He.a)(a,[{key:"process",value:function(){this.physicsWorld.Step(this.world.delta,8,3)}}]),a}(c.System),p=Object(Re.a)(h.prototype,"physicsWorld",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h),Pe=(y=Object(c.Inject)("viewport"),j=Object(c.Inject)("playerPosition"),d=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"viewport",O,Object(Te.a)(e)),Object(Se.a)(e,"playerPos",v,Object(Te.a)(e)),e}return Object(He.a)(a,[{key:"process",value:function(){var e=this.viewport.getCamera().getPosition();this.viewport.getCamera().setPosition(this.playerPos.x-u.GAP,e.y)}}]),a}(c.System),O=Object(Re.a)(d.prototype,"viewport",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Object(Re.a)(d.prototype,"playerPos",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d),Le=(g=Object(c.Inject)("viewport"),f=Object(c.Inject)("physicsWorld"),m=Object(c.Inject)("blocks"),w=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).generatedStep=0,Object(Se.a)(e,"viewport",A,Object(Te.a)(e)),Object(Se.a)(e,"physicsWorld",E,Object(Te.a)(e)),Object(Se.a)(e,"blocks",I,Object(Te.a)(e)),e}return Object(He.a)(a,[{key:"createBox",value:function(e,t,a,i,r){var n=new s.b2BodyDef;n.type=s.b2BodyType.b2_staticBody,n.position.Set(e,t);var o=this.physicsWorld.CreateBody(n);o.SetUserData({type:"block"});var c=new s.b2PolygonShape;c.SetAsBox(a/2,i/2),o.CreateFixture(c),this.blocks.push({x:e,y:t,w:a,h:i,type:r,body:o})}},{key:"initialized",value:function(){for(;this.generatedStep<3;)this.generateBlocks(this.generatedStep*u.BLOCK_BLOCK_SIZE),this.generatedStep++}},{key:"process",value:function(){for(var e=this.viewport.getCamera().getPosition(),t=Math.floor(e.x/u.BLOCK_BLOCK_SIZE);this.generatedStep<=t+1;)this.generateBlocks(this.generatedStep*u.BLOCK_BLOCK_SIZE),this.generatedStep++}},{key:"generateBlocks",value:function(e){for(var t=0;t<3;t++)for(var a=0;a<3;a++)Math.random()>.3&&this.createBox(e+u.BLOCK_SIZE*t,u.BLOCK_OFFSET_Y+u.BLOCK_SIZE*a,u.BLOCK_SIZE,u.BLOCK_SIZE,Math.floor(3*Math.random()))}}]),a}(c.System),A=Object(Re.a)(w.prototype,"viewport",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(Re.a)(w.prototype,"physicsWorld",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(Re.a)(w.prototype,"blocks",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w),Be=a(11),Ge=(_=Object(c.Inject)("viewport"),C=Object(c.Inject)("context"),S=Object(c.Inject)("blocks"),H=Object(c.Inject)("assetManager"),T=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"viewport",x,Object(Te.a)(e)),Object(Se.a)(e,"gl",k,Object(Te.a)(e)),Object(Se.a)(e,"blocks",R,Object(Te.a)(e)),Object(Se.a)(e,"assetManager",M,Object(Te.a)(e)),e.batch=void 0,e.whiteTex=void 0,e.atlas=void 0,e.regions=void 0,e}return Object(He.a)(a,[{key:"initialized",value:function(){this.batch=Object(o.e)(this.gl),this.whiteTex=Object(o.k)(this.gl);var e=this.assetManager.getAtlas("./ground.atlas");e&&(this.atlas=e,this.regions=e.findRegions("tile"))}},{key:"process",value:function(){this.batch.setProjection(this.viewport.getCamera().combined),this.batch.begin();var e,t=Object(Be.a)(this.blocks);try{for(t.s();!(e=t.n()).done;){var a=e.value,i=a.x,r=a.y,n=a.w,o=a.h,s=a.type;this.regions[s].draw(this.batch,i-n/2,r-o/2,n,o)}}catch(c){t.e(c)}finally{t.f()}this.batch.end()}}]),a}(c.System),x=Object(Re.a)(T.prototype,"viewport",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(Re.a)(T.prototype,"gl",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(Re.a)(T.prototype,"blocks",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(Re.a)(T.prototype,"assetManager",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T),De=(P=Object(c.Inject)("physicsWorld"),L=Object(c.Inject)("playerPosition"),B=Object(c.Inject)("inputHandler"),G=Object(c.Inject)("playerState"),D=Object(c.Inject)("eventEmitter"),W=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"physicsWorld",z,Object(Te.a)(e)),Object(Se.a)(e,"playerPos",F,Object(Te.a)(e)),Object(Se.a)(e,"inputHandler",Y,Object(Te.a)(e)),Object(Se.a)(e,"playerState",K,Object(Te.a)(e)),Object(Se.a)(e,"eventEmitter",U,Object(Te.a)(e)),e.playerBody=void 0,e.stunnedDuration=0,e.pressed=!1,e.jumpLeft=0,e.gameOver=!1,e.zeroCenter={x:0,y:0},e.runImpulse={x:u.RUN_FORCE,y:0},e.jumpImpulse={x:0,y:u.JUMP_FORCE},e}return Object(He.a)(a,[{key:"initialized",value:function(){var e=new s.b2BodyDef;e.type=s.b2BodyType.b2_dynamicBody,e.fixedRotation=!0,e.position.Set(2,2);var t=this.physicsWorld.CreateBody(e),a=new s.b2CircleShape(u.PLAYER_WIDTH);a.Set({x:-u.PLAYER_WIDTH/2,y:-u.PLAYER_HEIGHT/2},u.PLAYER_WIDTH),t.CreateFixture(a);var i=new s.b2PolygonShape;i.SetAsBox(u.PLAYER_WIDTH/8,u.PLAYER_WIDTH/8,{x:0,y:u.PLAYER_HEIGHT/2});var r=new s.b2FixtureDef;r.isSensor=!0,r.shape=i,r.userData={type:"playerSensor"},t.CreateFixture(r);var n=new s.b2PolygonShape;n.SetAsBox(u.PLAYER_WIDTH/8,u.PLAYER_WIDTH/8,{x:u.PLAYER_WIDTH/2,y:0});var o=new s.b2FixtureDef;o.isSensor=!0,o.shape=n,o.userData={type:"playerSensor2"},t.CreateFixture(o),this.playerBody=t;var c=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(e){var i;return Object(l.a)(this,a),(i=t.call(this)).movementSytem=void 0,i.movementSytem=e,i}return Object(He.a)(a,[{key:"processJumpable",value:function(e){var t,a,i,r,n=e.GetFixtureA(),o=e.GetFixtureB();n.IsSensor()&&"playerSensor"===(null===(t=n.GetUserData())||void 0===t?void 0:t.type)?r=o:o.IsSensor()&&"playerSensor"===(null===(a=o.GetUserData())||void 0===a?void 0:a.type)&&(r=n),r&&"block"===(null===(i=r.GetBody().GetUserData())||void 0===i?void 0:i.type)&&(this.movementSytem.jumpLeft=2,this.movementSytem.playerState.changeAction("run"))}},{key:"processObstacle",value:function(e){var t,a,i,r,n=e.GetFixtureA(),o=e.GetFixtureB();n.IsSensor()&&"playerSensor2"===(null===(t=n.GetUserData())||void 0===t?void 0:t.type)?r=o:o.IsSensor()&&"playerSensor2"===(null===(a=o.GetUserData())||void 0===a?void 0:a.type)&&(r=n),r&&"block"===(null===(i=r.GetBody().GetUserData())||void 0===i?void 0:i.type)&&(this.movementSytem.stunnedDuration=.2,this.movementSytem.playerBody.GetLinearVelocity().Set(0,0),this.movementSytem.playerBody.ApplyLinearImpulse({x:-2.5*u.RUN_FORCE,y:0},{x:0,y:0}),this.movementSytem.playerState.changeAction("hurt"))}},{key:"BeginContact",value:function(e){this.processJumpable(e),this.processObstacle(e)}}]),a}(s.b2ContactListener);this.physicsWorld.SetContactListener(new c(this))}},{key:"process",value:function(){if(this.stunnedDuration>0)this.stunnedDuration-=this.world.delta,this.stunnedDuration<=0&&this.playerState.changeAction("run");else{var e=this.playerBody.GetLinearVelocity();if(e.Set(0,e.y),this.playerBody.ApplyLinearImpulse(this.runImpulse,this.zeroCenter),this.pressed)this.inputHandler.isTouched()||(this.pressed=!1);else if(this.inputHandler.isTouched()&&this.jumpLeft>0){this.jumpLeft--,1===this.jumpLeft?this.playerState.changeAction("jump"):this.playerState.changeAction("doubleJump"),this.pressed=!0;var t=this.playerBody.GetLinearVelocity();t.Set(t.x,0),this.playerBody.ApplyLinearImpulse(this.jumpImpulse,this.zeroCenter)}}var a=this.playerBody.GetPosition();this.playerPos.set(a.x,a.y),!this.gameOver&&a.y>1.2*u.CAMERA_HEIGHT&&(this.gameOver=!0,this.eventEmitter.emit("gameOver"))}}]),a}(c.System),z=Object(Re.a)(W.prototype,"physicsWorld",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(Re.a)(W.prototype,"playerPos",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=Object(Re.a)(W.prototype,"inputHandler",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(Re.a)(W.prototype,"playerState",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Object(Re.a)(W.prototype,"eventEmitter",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W),We=(J=Object(c.Inject)("viewport"),Z=Object(c.Inject)("context"),V=Object(c.Inject)("playerPosition"),N=Object(c.Inject)("assetManager"),q=Object(c.Inject)("playerState"),Q=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"viewport",X,Object(Te.a)(e)),Object(Se.a)(e,"gl",$,Object(Te.a)(e)),Object(Se.a)(e,"playerPos",ee,Object(Te.a)(e)),Object(Se.a)(e,"assetManager",te,Object(Te.a)(e)),Object(Se.a)(e,"playerState",ae,Object(Te.a)(e)),e.batch=void 0,e.whiteTex=void 0,e.atlas=void 0,e.animations={},e.animationFrameDuration={run:.13,jump:.1,doubleJump:.1,hurt:.05},e}return Object(He.a)(a,[{key:"initialized",value:function(){this.batch=Object(o.e)(this.gl),this.whiteTex=Object(o.k)(this.gl);var e=this.assetManager.getAtlas("./main-char.atlas");e&&(this.atlas=e)}},{key:"getAnimation",value:function(e,t){var a="".concat(e).concat(t);if(!this.animations[a]){var i=this.animationFrameDuration[e]||.1,r=this.atlas.findRegions(a);"jump"!==e&&"doubleJump"!==e||(r=r.slice(0,r.length-2)),this.animations[a]=Object(o.d)(i,r)}return this.animations[a]}},{key:"process",value:function(){this.batch.setProjection(this.viewport.getCamera().combined),this.batch.begin();var e=this.playerPos,t=e.x,a=e.y;this.playerState.process(this.world.delta);var i=o.a.LOOP;"jump"!==this.playerState.action&&"doubleJump"!==this.playerState.action||(i=o.a.NORMAL),this.getAnimation(this.playerState.action,this.playerState.state).getKeyFrame(this.playerState.stateTime,i).draw(this.batch,t-u.PLAYER_WIDTH/2,a-u.PLAYER_HEIGHT/2,u.PLAYER_WIDTH,u.PLAYER_HEIGHT,u.PLAYER_WIDTH/2,u.PLAYER_HEIGHT,0,u.PLAYER_SCALE,u.PLAYER_SCALE),this.batch.end()}}]),a}(c.System),X=Object(Re.a)(Q.prototype,"viewport",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Object(Re.a)(Q.prototype,"gl",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Object(Re.a)(Q.prototype,"playerPos",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Object(Re.a)(Q.prototype,"assetManager",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=Object(Re.a)(Q.prototype,"playerState",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q),ze=(ie=Object(c.Inject)("viewport"),re=Object(c.Inject)("physicsWorld"),ne=Object(c.Inject)("blocks"),oe=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"viewport",se,Object(Te.a)(e)),Object(Se.a)(e,"physicsWorld",ce,Object(Te.a)(e)),Object(Se.a)(e,"blocks",le,Object(Te.a)(e)),e}return Object(He.a)(a,[{key:"process",value:function(){for(var e=this.viewport.getCamera().getPosition(),t=this.blocks.length-1;t>=0;t--){var a=this.blocks[t];e.x-a.x>=3*u.CAMERA_WIDTH&&(this.physicsWorld.DestroyBody(a.body),this.blocks.splice(t,1))}}}]),a}(c.System),se=Object(Re.a)(oe.prototype,"viewport",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=Object(Re.a)(oe.prototype,"physicsWorld",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=Object(Re.a)(oe.prototype,"blocks",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe),Fe=function(){function e(t){Object(l.a)(this,e),this.gl=void 0,this.promises=[],this.atlases=new Map,this.textures=new Map,this.done=0,this.gl=t}return Object(He.a)(e,[{key:"loadAtlas",value:function(e){var t=this,a=Object(o.l)(this.gl,e,{}).then((function(a){t.atlases.set(e,a),t.done++}));this.promises.push(a)}},{key:"getAtlas",value:function(e){return this.atlases.get(e)}},{key:"loadTexture",value:function(e){var t=this,a=Object(o.m)(this.gl,e,{}).then((function(a){t.textures.set(e,a),t.done++}));this.promises.push(a)}},{key:"getTexture",value:function(e){return this.textures.get(e)}},{key:"finishLoading",value:function(){var e=Object(n.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.promises);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}}]),e}(),Ye=function(){function e(){Object(l.a)(this,e),this.action="run",this.state="A",this.stateTime=0}return Object(He.a)(e,[{key:"changeAction",value:function(e){this.action=e,this.stateTime=0}},{key:"changeState",value:function(e){this.state=e}},{key:"process",value:function(e){this.stateTime+=e}}]),e}(),Ke=(ue=Object(c.Inject)("context"),be=Object(c.Inject)("assetManager"),he=Object(c.Inject)("fixedCamera"),pe=Object(c.Inject)("playerPosition"),ye=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"gl",je,Object(Te.a)(e)),Object(Se.a)(e,"assetManager",de,Object(Te.a)(e)),Object(Se.a)(e,"fixedCamera",Oe,Object(Te.a)(e)),Object(Se.a)(e,"playerPos",ve,Object(Te.a)(e)),e.batch=void 0,e.textures=new Map,e}return Object(He.a)(a,[{key:"initialized",value:function(){var e=this;this.batch=Object(o.e)(this.gl),["bg","city_01","city_02","cloud_01","cloud_02","smoke_01","smoke_02"].map((function(t){return e.textures.set(t,e.assetManager.getTexture("./background/".concat(t,".png")))}))}},{key:"drawBackground",value:function(){for(var e=this.textures.get("bg"),t=u.CAMERA_HEIGHT,a=t/e.height*e.width,i=0;i*a<u.CAMERA_WIDTH;)this.batch.draw(e,i*a,0,a,t),i++}},{key:"process",value:function(){var e=-this.playerPos.x;this.batch.setProjection(this.fixedCamera.combined),this.batch.begin(),this.drawBackground(),this.drawCloud1(.5*e),this.drawCloud2(.8*e),this.drawCity1(e),this.drawCity2(1.1*e),this.batch.end()}},{key:"drawCity1",value:function(e){for(var t=this.textures.get("city_01"),a=u.CAMERA_HEIGHT/1.5,i=a/t.height*t.width;e<=0;)e+=i;for(this.batch.draw(t,e-i,u.CAMERA_HEIGHT-a,i,a);e<=u.CAMERA_WIDTH;)this.batch.draw(t,e,u.CAMERA_HEIGHT-a,i,a),e+=i}},{key:"drawCity2",value:function(e){for(var t=this.textures.get("city_02"),a=u.CAMERA_HEIGHT/1.5,i=a/t.height*t.width;e<=0;)e+=i;for(this.batch.draw(t,e-i,u.CAMERA_HEIGHT-a,i,a);e<=u.CAMERA_WIDTH;)this.batch.draw(t,e,u.CAMERA_HEIGHT-a,i,a),e+=i}},{key:"drawCloud1",value:function(e){for(var t=this.textures.get("cloud_01"),a=u.CAMERA_HEIGHT/1.2,i=a/t.height*t.width,r=i;e<=0;)e+=i+r;for(this.batch.draw(t,e-i,u.CAMERA_HEIGHT-a,i,a);e+r<=u.CAMERA_WIDTH;)this.batch.draw(t,e+r,u.CAMERA_HEIGHT-a,i,a),e+=i+r}},{key:"drawCloud2",value:function(e){for(var t=this.textures.get("cloud_02"),a=u.CAMERA_HEIGHT/6,i=a/t.height*t.width,r=i;e<=0;)e+=i+r;for(this.batch.draw(t,e-i,u.CAMERA_HEIGHT/4,i,a);e+r<=u.CAMERA_WIDTH;)this.batch.draw(t,e+r,u.CAMERA_HEIGHT/4,i,a),e+=i+r}}]),a}(c.System),je=Object(Re.a)(ye.prototype,"gl",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de=Object(Re.a)(ye.prototype,"assetManager",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=Object(Re.a)(ye.prototype,"fixedCamera",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=Object(Re.a)(ye.prototype,"playerPos",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye),Ue=(ge=Object(c.Inject)("context"),fe=Object(c.Inject)("assetManager"),me=Object(c.Inject)("fixedCamera"),we=Object(c.Inject)("playerPosition"),Ae=function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(l.a)(this,a);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(Se.a)(e,"gl",Ee,Object(Te.a)(e)),Object(Se.a)(e,"assetManager",Ie,Object(Te.a)(e)),Object(Se.a)(e,"fixedCamera",_e,Object(Te.a)(e)),Object(Se.a)(e,"playerPos",Ce,Object(Te.a)(e)),e.batch=void 0,e.textures=new Map,e}return Object(He.a)(a,[{key:"initialized",value:function(){var e=this;this.batch=Object(o.e)(this.gl),["bg","city_01","city_02","cloud_01","cloud_02","smoke_01","smoke_02"].map((function(t){return e.textures.set(t,e.assetManager.getTexture("./background/".concat(t,".png")))}))}},{key:"process",value:function(){var e=-this.playerPos.x;this.batch.setProjection(this.fixedCamera.combined),this.batch.begin(),this.drawCloud1(.05*e),this.drawCloud2(.1*e),this.batch.end()}},{key:"drawCloud1",value:function(e){for(var t=this.textures.get("smoke_01"),a=u.CAMERA_HEIGHT/5,i=a/t.height*t.width,r=-i/1.5;e<=0;)e+=i+r;for(this.batch.draw(t,e-i,u.CAMERA_HEIGHT-a/2,i,a);e+r<=u.CAMERA_WIDTH;)this.batch.draw(t,e+r,u.CAMERA_HEIGHT-a/2,i,a),e+=i+r}},{key:"drawCloud2",value:function(e){for(var t=this.textures.get("smoke_02"),a=u.CAMERA_HEIGHT/5,i=a/t.height*t.width,r=-i/1.5;e<=0;)e+=i+r;for(this.batch.draw(t,e-i,u.CAMERA_HEIGHT-a/2,i,a);e+r<=u.CAMERA_WIDTH;)this.batch.draw(t,e+r,u.CAMERA_HEIGHT-a/2,i,a),e+=i+r}}]),a}(c.System),Ee=Object(Re.a)(Ae.prototype,"gl",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie=Object(Re.a)(Ae.prototype,"assetManager",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(Re.a)(Ae.prototype,"fixedCamera",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=Object(Re.a)(Ae.prototype,"playerPos",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae),Je=a(23);(function(){var e=Object(n.a)(r.a.mark((function e(){var t,a,i,n,l,b,h,p,y,j,d,O,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Je.EventEmitter,a=Object(o.h)(),i=a.getCanvas(),n=a.getInfo(),l=Object(o.i)(i,u.CAMERA_WIDTH,u.CAMERA_HEIGHT,{pixelRatio:1}),b=l.getContext(),h=Object(o.j)(i,l),p=Object(o.g)(u.CAMERA_WIDTH,u.CAMERA_HEIGHT,i.width,i.height),l.addCamera(p),l.update(),(y=new Fe(b)).loadAtlas("./main-char.atlas"),y.loadAtlas("./ground.atlas"),["bg","city_01","city_02","cloud_01","cloud_02","smoke_01","smoke_02"].map((function(e){return y.loadTexture("./background/".concat(e,".png"))})),n.innerHTML="Loading...",e.next=17,y.finishLoading();case 17:j=function(){var e=new s.b2World({x:0,y:u.GRAVITY}),a=new c.World;return a.register("context",b),a.register("physicsWorld",e),a.register("viewport",l),a.register("blocks",[]),a.register("playerPosition",new o.c(0,0)),a.register("inputHandler",h),a.register("assetManager",y),a.register("playerState",new Ye),a.register("fixedCamera",p),a.register("eventEmitter",t),a.addSystem(new Le,!0),a.addSystem(new De,!0),a.addSystem(new ze,!0),a.addSystem(new Me,!0),a.addSystem(new Pe,!1),a.addSystem(new Ke,!1),a.addSystem(new Ge,!1),a.addSystem(new We,!1),a.addSystem(new Ue,!1),a},d=j(),O=!1,t.addListener("gameOver",(function(){O=!0,d.dispose(),setTimeout((function(){d=j(),O=!1}),1e3)})),b.clearColor(0,0,0,1),v=Object(o.f)((function(e){b.clear(b.COLOR_BUFFER_BIT),d.setDelta(e),!O&&d.processActiveSystem(),d.processPassiveSystem()})),setInterval((function(){return n.innerHTML="FPS: ".concat(v.getFps())}),500);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}},[[89,1,2]]]);
//# sourceMappingURL=main.e3ad8d51.chunk.js.map